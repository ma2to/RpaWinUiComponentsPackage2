<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="RpaWinUiComponentsPackage.AdvancedWinUiDataGrid.Controls.AdvancedDataGrid"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    d:DesignHeight="300"
    d:DesignWidth="400">

    <UserControl.Resources>
        <!-- Default cell template -->
        <DataTemplate x:Key="DefaultCellTemplate">
            <Border x:Name="CellBorder" 
                    BorderThickness="1"
                    BorderBrush="{ThemeResource ControlStrokeColorSecondary}"
                    Background="{ThemeResource ControlFillColorDefault}">
                <TextBox x:Name="CellTextBox"
                         Text="{Binding Value, Mode=TwoWay}"
                         BorderThickness="0"
                         Background="Transparent"
                         Padding="8,4"
                         IsReadOnly="{Binding IsReadOnly}"
                         TextWrapping="Wrap"
                         AcceptsReturn="True" />
            </Border>
        </DataTemplate>

        <!-- Header template -->
        <DataTemplate x:Key="HeaderTemplate">
            <Border BorderThickness="0,0,1,1"
                    BorderBrush="{ThemeResource ControlStrokeColorSecondary}"
                    Background="{ThemeResource ControlFillColorSecondary}"
                    Padding="8,4">
                <TextBlock Text="{Binding DisplayName}"
                           FontWeight="SemiBold"
                           VerticalAlignment="Center"
                           TextTrimming="CharacterEllipsis" />
            </Border>
        </DataTemplate>

    </UserControl.Resources>

    <Grid x:Name="RootGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" /> <!-- Header row -->
            <RowDefinition Height="*" />    <!-- Data area -->
        </Grid.RowDefinitions>

        <!-- Column Headers -->
        <ScrollViewer x:Name="HeaderScrollViewer"
                      Grid.Row="0"
                      HorizontalScrollBarVisibility="Hidden"
                      VerticalScrollBarVisibility="Disabled"
                      ZoomMode="Disabled">
            <ItemsRepeater x:Name="HeaderRepeater"
                           ItemTemplate="{StaticResource HeaderTemplate}" />
        </ScrollViewer>

        <!-- Data Grid Area -->
        <ScrollViewer x:Name="DataScrollViewer"
                      Grid.Row="1"
                      HorizontalScrollBarVisibility="Auto"
                      VerticalScrollBarVisibility="Auto"
                      ZoomMode="Disabled">
            <ItemsRepeater x:Name="DataRepeater"
                           ItemTemplate="{StaticResource DefaultCellTemplate}" />
        </ScrollViewer>

        <!-- Loading indicator -->
        <ProgressRing x:Name="LoadingRing"
                      Grid.Row="1"
                      IsActive="False"
                      Visibility="Collapsed"
                      Width="50"
                      Height="50"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center" />

        <!-- Status bar -->
        <Border x:Name="StatusBar"
                Grid.Row="1"
                VerticalAlignment="Bottom"
                Background="{ThemeResource SystemControlBackgroundAltHighBrush}"
                BorderThickness="0,1,0,0"
                BorderBrush="{ThemeResource ControlStrokeColorSecondary}"
                Padding="8,4"
                Visibility="Collapsed">
            <TextBlock x:Name="StatusText"
                       Text="Ready"
                       FontSize="12"
                       Foreground="{ThemeResource TextFillColorSecondary}" />
        </Border>
    </Grid>
</UserControl>